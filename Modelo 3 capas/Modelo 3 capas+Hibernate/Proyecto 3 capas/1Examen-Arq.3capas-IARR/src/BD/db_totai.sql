create database db_totai;
--uses db_totai;

create table empleado(

    CODIGO          VARCHAR(10) NOT NULL,
    CI              INT NOT NULL,
    NOMBRE 	    VARCHAR(50) NOT NULL,
    FECHA_INGRESO   DATE NOT NULL,
    CARGO 	    VARCHAR(50) NOT NULL,

    CONSTRAINT empleado_CODIGO_key UNIQUE(CODIGO),
    PRIMARY KEY (CODIGO)
);

select *from empleado;

create table curso(

	IDCURSO         VARCHAR(10) NOT NULL,
	TITULO 	        VARCHAR(50) NOT NULL,
	NUMERO_HORAS    INT NOT NULL,

	CONSTRAINT curso_IDCURSO_key UNIQUE(IDCURSO),
	PRIMARY KEY(IDCURSO)
);
select *from curso;

create table requisitos(

	IDCURSO          VARCHAR(10) NOT NULL,
	PRE_REQUISITO    VARCHAR(10) NOT NULL,

	PRIMARY KEY(IDCURSO,PRE_REQUISITO),
	FOREIGN KEY (IDCURSO) REFERENCES curso(IDCURSO)on delete cascade on update cascade,
	FOREIGN KEY (PRE_REQUISITO) REFERENCES curso(IDCURSO)on delete cascade on update cascade
);
select *from requisitos;

create table aula(

	IDAULA 	     VARCHAR(10) NOT NULL,
	CAPACIDAD    INT NOT NULL,

	CONSTRAINT aula_IDAULA_key UNIQUE(IDAULA),
	PRIMARY KEY (IDAULA)
);

select *from aula;

create table tema(

	IDTEMA 	  VARCHAR(10) NOT NULL,
	TEMA 	  VARCHAR(50) NOT NULL,

	CONSTRAINT tema_IDTEMA_key UNIQUE(IDTEMA),
	PRIMARY KEY(IDTEMA)
);
select *from tema;

create table edicion(

	CODIGO 		VARCHAR(10) NOT NULL,
	FECHA_INI 	DATE NOT NULL,
	FECHA_FIN 	DATE NOT NULL,
	IDTEMA 		VARCHAR(10) NOT NULL,
	IDCURSO 	VARCHAR(10) NOT NULL,
	IDAULA 		VARCHAR(10) NOT NULL,
	IDEMPLEADO 	VARCHAR(10) NOT NULL,

	PRIMARY KEY(CODIGO),
	FOREIGN KEY (IDTEMA) REFERENCES tema(IDTEMA)on delete cascade on update cascade,
	FOREIGN KEY (IDCURSO) REFERENCES curso(IDCURSO)on delete cascade on update cascade,
	FOREIGN KEY (IDAULA) REFERENCES aula(IDAULA)on delete cascade on update cascade,
	FOREIGN KEY (IDEMPLEADO) REFERENCES empleado(CODIGO)on delete cascade on update cascade

);
select *from edicion;

create table horario(

	IDHORA 		SERIAL NOT NULL,
	DIAS 		VARCHAR(20) NOT NULL,
	HORA_INI 	TIME NOT NULL,
	HORA_FIN 	TIME NOT NULL,
	IDEDICION 	VARCHAR(10) NOT NULL,

	CONSTRAINT horario_IDHORA_key UNIQUE(IDHORA),
	PRIMARY KEY (IDHORA),
	FOREIGN KEY (IDEDICION) REFERENCES edicion(CODIGO)on delete cascade on update cascade

);
select *from horario;

create table inscripcion(

	CODIGO			SERIAL NOT NULL,
	DESCRIPCION		VARCHAR(50),
	FECHA			DATE NOT NULL,
	IDEDICION 		VARCHAR(10) NOT NULL,
	IDEMPLEADO 		VARCHAR(10) NOT NULL,

	CONSTRAINT inscripcion_CODIGO_key UNIQUE(CODIGO),
	PRIMARY KEY(CODIGO),
	FOREIGN KEY (IDEDICION) REFERENCES edicion(CODIGO)on delete cascade on update cascade,
	FOREIGN KEY (IDEMPLEADO) REFERENCES empleado(CODIGO)on delete cascade on update cascade


);
select *from inscripcion;


create table calificacion(
	IDEMPLEADO 		VARCHAR(10) NOT NULL,
	IDEDICION 		VARCHAR(10) NOT NULL,
	NOTA			INT NOT NULL,

	PRIMARY KEY(IDEDICION,IDEMPLEADO),
	FOREIGN KEY (IDEDICION) REFERENCES edicion(CODIGO)on delete cascade on update cascade,
	FOREIGN KEY (IDEMPLEADO) REFERENCES empleado(CODIGO)on delete cascade on update cascade

);
select *from calificacion;

INSERT INTO empleado VALUES('E01',4715608,'ISABEL RODRIGUEZ','2011/07/05','SECRETARIA');
INSERT INTO empleado VALUES('E02',6296986,'DIEGO VARGAS LARA','2010/03/21','SUPERVISOR DE ALMACEN');
INSERT INTO empleado VALUES('E03',7563710,'CECILIA GARCIA','2011/04/02','RECEPCIONISTA');
select *from empleado;

INSERT INTO curso VALUES('C01','INFORMATICA BASICA',35);
INSERT INTO curso VALUES('C02','INTRODUCCION A LA PROGRAMACION',45);
INSERT INTO curso VALUES('C03','PROGRAMACION AVANZADA',25);
INSERT INTO curso VALUES('C04','JAVA BASICO',25);
INSERT INTO curso VALUES('C05','JAVA AVANZADO',30);
INSERT INTO curso VALUES('C06','INTRODUCCION A PHP',30);
INSERT INTO curso VALUES('C07','DESARROLLO DE PAGINAS WEB',45);
INSERT INTO curso VALUES('C08','DELPHI BASICO',25);
INSERT INTO curso VALUES('C09','DELPHI AVANZADO',45);
select *from curso;


INSERT INTO requisitos VALUES('C02','C01');
INSERT INTO requisitos VALUES('C03','C02');
INSERT INTO requisitos VALUES('C04','C02');
INSERT INTO requisitos VALUES('C05','C04');
INSERT INTO requisitos VALUES('C07','C06');
INSERT INTO requisitos VALUES('C09','C08');
select *from requisitos;


INSERT INTO aula VALUES('A01',25);
INSERT INTO aula VALUES('A02',40);
INSERT INTO aula VALUES('A03',35);
INSERT INTO aula VALUES('A04',50);
INSERT INTO aula VALUES('A05',30);
INSERT INTO aula VALUES('A06',40);
select *from aula;


INSERT INTO tema VALUES('T01','INTRODUCCION A LA INFORMATICA');
INSERT INTO tema VALUES('T02','ALGORITMOS Y DIAGRAMAS DE FLUJO');
INSERT INTO tema VALUES('T03','PROGRAMACION ORIENTADA A OBJETOS');
INSERT INTO tema VALUES('T04','ESTRUCTURA DE DATOS');
INSERT INTO tema VALUES('T05','APRENDIENDO JAVA DESCE CERO');
INSERT INTO tema VALUES('T06','INTRODUCCION A DELPHI');
INSERT INTO tema VALUES('T07','FUNDAMENTOS BASICOS DE DELPHI');
INSERT INTO tema VALUES('T08','DISEÃ‘O DE APLICACIONES EN PHP');
INSERT INTO tema VALUES('T09','EL LENGUAJE HTML y PHP');

select *from tema;

INSERT INTO edicion VALUES('ED1-01','2011/01/03','2011/01/30','T01','C01','A02','E01');
INSERT INTO edicion VALUES('ED1-02','2011/02/12','2011/02/25','T02','C02','A01','E01');
INSERT INTO edicion VALUES('ED1-03','2011/01/03','2011/01/30','T01','C01','A02','E02');
INSERT INTO edicion VALUES('ED1-04','2011/02/12','2011/02/25','T02','C02','A01','E02');
INSERT INTO edicion VALUES('ED2-01','2011/03/05','2011/04/20','T09','C06','A03','E03');
INSERT INTO edicion VALUES('ED2-02','2011/04/02','2011/04/28','T08','C07','A04','E03');
INSERT INTO edicion VALUES('ED2-03','2011/05/05','2011/05/30','T07','C08','A05','E03');

select *from edicion;


INSERT INTO horario VALUES(DEFAULT,'LU-MIE-VI','19:30:00','21:30:00','ED1-01');
INSERT INTO horario VALUES(DEFAULT,'MAR-JUE','18:30:00','22:00:00','ED1-02');
INSERT INTO horario VALUES(DEFAULT,'SAB','16:30:00','20:30:00','ED1-03');
INSERT INTO horario VALUES(DEFAULT,'LUN-MIE-VIE','18:30:00','20:30:00','ED1-04');
INSERT INTO horario VALUES(DEFAULT,'MAR-JUE','19:30:00','22:30:00','ED2-01');
INSERT INTO horario VALUES(DEFAULT,'LUN-MIE-VIE','18:30:00','20:30:00','ED2-02');
INSERT INTO horario VALUES(DEFAULT,'SAB','16:30:00','20:30:00','ED2-03');

select *from horario;



INSERT INTO inscripcion VALUES(DEFAULT,'INSCRIPCION EXITOSA','2011/01/03','ED1-01','E01');
INSERT INTO inscripcion VALUES(DEFAULT,'INSCRIPCION EXITOSA','2011/02/10','ED1-02','E01');
INSERT INTO inscripcion VALUES(DEFAULT,'INSCRIPCION EXITOSA','2011/01/03','ED1-03','E02');
INSERT INTO inscripcion VALUES(DEFAULT,'INSCRIPCION EXITOSA','2011/02/12','ED1-04','E02');
INSERT INTO inscripcion VALUES(DEFAULT,'INSCRIPCION EXITOSA','2011/03/05','ED2-01','E03');
INSERT INTO inscripcion VALUES(DEFAULT,'INSCRIPCION EXITOSA','2011/04/02','ED2-02','E03');
INSERT INTO inscripcion VALUES(DEFAULT,'INSCRIPCION EXITOSA','2011/05/05','ED2-03','E03');
select *from inscripcion;


INSERT INTO calificacion VALUES('E01','ED1-01',65);
INSERT INTO calificacion VALUES('E01','ED1-02',70);
INSERT INTO calificacion VALUES('E02','ED1-03',51);
INSERT INTO calificacion VALUES('E02','ED1-04',82);
INSERT INTO calificacion VALUES('E03','ED2-01',59);
INSERT INTO calificacion VALUES('E03','ED2-02',72);
INSERT INTO calificacion VALUES('E03','ED2-03',60);
select *from calificacion;


--// MOSTRAR TODOS LOS CURSO + LOS PRE-REQUISITOS.

select curso.IDCURSO, curso.TITULO, curso.NUMERO_HORAS, requisitos.PRE_REQUISITO
 from curso left join requisitos
   on (curso.IDCURSO=requisitos.IDCURSO);

